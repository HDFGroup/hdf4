# ****************************************************************************
# * NCSA HDF                                                                 *
# * Software Development Group                                               *
# * National Center for Supercomputing Applications                          *
# * University of Illinois at Urbana-Champaign                               *
# * 605 E. Springfield, Champaign IL 61820                                   *
# *                                                                          *
# * For conditions of distribution and use, see the accompanying             *
# * hdf/COPYING file.                                                        *
# *                                                                          *
# ***************************************************************************
#
# $Id$
#

.SUFFIXES : .f

# ==> specify your machine
#MACHINE=WIN3
MACHINE=PC

INCDIR=..\include
LIBDIR=..\lib
BINDIR=..\bin

# ==> where are your hdf.h, hdfi.h and vg.h files located?
IFLAGS=   /I$(INCDIR) /I.

# ==> specify your FORTRAN compiler
FC=fl
FFLAGS= /c /Gt64 /AH /4I4 $(IFLAGS) /W2 /Od /Tf

# ==> specify your C compiler
CC=cl
#CFLAGS=  /c /D$(MACHINE) /NTt$* /ND$* /Gt64 /AH /W4 /Od $(IFLAGS) /Zi /Zp1
#CFLAGS=  /c /D$(MACHINE) /NTt$* /ND$* /Gt64 /AH /W4 /Ozaxb2 $(IFLAGS) /Zp1
CFLAGS=  /c /D$(MACHINE) /Gt32 /AH /W4 /Od $(IFLAGS) /Zi /Mq /DTEST_PC /DTEST_WIN
#CFLAGS=  /c /D$(MACHINE) /Gt32 /AH /W4 /Od $(IFLAGS) /Zi

# ==> where is your HDF library (libdf.a) located?
LIBS= $(LIBDIR)\df.lib

#BDIR=../backup

# ==> specify your archiver
AR=lib
ARFLAGS=
ARFLAGS2=/NOLOGO /PAGE:32 -+

# ==> specify your linker
LN=link
LNFLAGS=/INFO /COD /ST:8192 /MAP:FULL /SEG:256

# ==> specify your archive randomizer
#RANLIB=ranlib

RM=del
RMFLAGS=
LINTFLAGS=
SHAR=zip
ARCHIVE=hdf.zip

SRCS=   testhdf.c rig.c sdstr.c blocks.c an.c anfile.c \
        extelt.c file.c file1.c vers.c sdmms.c \
        sdnmms.c slab.c litend.c

CTESTS= testhdf.obj rig.obj sdstr.obj blocks.obj an.obj anfile.obj \
        extelt.obj file.obj file1.obj vers.obj sdmms.obj \
        sdnmms.obj slab.obj litend.obj

FTESTS= tr8f.exe t24f.exe tpf.exe tanf.exe tanfilef.exe tsdstrf.exe tsdntf.exe tsdnntf.exe \
        tsdmmsf.exe tsdnmmsf.exe tstubsf.exe \
        slabwf.exe slab1wf.exe slab2wf.exe slab3wf.exe slab4wf.exe
TESTF = fortest.obj
FOBJS = tr8f.obj t24f.obj tpf.obj tanf.obj tanfilef.obj tsdstrf.obj tsdntf.obj \
        tsdnntf.obj tsdmmsf.obj tsdnmmsf.obj tstubsf.obj fortest.obj \
        slabwf.obj slab1wf.obj slab2wf.obj slab3wf.obj slab4wf.obj

.f.obj:
    $(FC) $(FFLAGS) $<

.c.obj:
    $(CC) $(CFLAGS) $<

all: testhdf fortest

nofortran: testhdf

testhdf: $(CTESTS) $(LIBDIR)\df.lib testhdf.obj
#    $(CC) $(CFLAGS) testhdf.c
    $(LN) $(LNFLAGS) @testhdf.lnk

fortest: $(FTESTS) $(LIBDIR)\df.lib fortest.obj
#    $(FC) $(FFLAGS) fortest.f
    $(LN) $(LNFLAGS) fortest $(FTESTS),,,$(LIBDIR)\df.lib;

clean:
    -$(RM) $(RMFLAGS) *.hdf *.obj *.exe

