#
# $Header$
#
# $Log$
# Revision 1.2.2.1  1993/10/19 17:37:28  koziol
# Tons of changes and updates.  Fixed the 0 length problem in Hstartwrite(),
# made all the 'void' returning routines in the Vsets return a succeed or
# fail.  Added N-Bit files (which aren't working yet...)
#
# Revision 1.2  1993/09/02  14:42:03  koziol
# Patches for Watcom/386 Support
#
# Revision 1.1  1993/08/16  21:46:16  koziol
# Wrapped in changes for final, working version on the PC.
#
# Revision 1.5  1993/04/19  22:48:21  koziol
# General Code Cleanup to reduce/remove errors on the PC
#
# Revision 1.4  1993/03/29  16:50:23  koziol
# Updated JPEG code to new JPEG 4 code.
# Changed VSets to use Threaded-Balanced-Binary Tree for internal
# 	(in memory) representation.
# Changed VGROUP * and VDATA * returns/parameters for all VSet functions
# 	to use 32-bit integer keys instead of pointers.
# Backed out speedups for Cray, until I get the time to fix them.
# Fixed a bunch of bugs in the little-endian support in DFSD.
#
# Revision 1.3  1993/01/26  19:42:55  koziol
# Added support for reading and writing Little-Endian data on all
# platforms.  This has been tested on: Cray, Sun, and PCs so far.
#
# Revision 1.2  1993/01/19  05:56:08  koziol
# Merged Hyperslab and JPEG routines with beginning of DEC ALPHA
# port.  Lots of minor annoyances fixed.
#
# Revision 1.1  1992/08/25  21:40:44  koziol
# Initial revision
#
#
# ##################################################################
#
#                   NCSA HDF Version 3.3 beta 1
#                         January 1993
#
#           MAKEFILE for creating the HDF library, libdf.a,
#
# This makefile creates the following FORTRAN and C interfaces 
# for HDF in a library called "df.lib":
#
#              DFR8   (8-bit raster image sets)
#              DF24   (24-bit raster image sets)
#              DFP    (palettes)
#              DFSD   (scientific data sets)
#              DFAN   (annotations)
#              V      (vsets)
#
# See the file INSTALL for further information on how to invoke
# this makefile.
#
# This release of HDF marks the first use of a new set of lower
# level routines.  The makefile also creates these interfaces,
# which are available in C only.  These routines are categorized
# as follows:
#
#              H      (new lower level i/o)
#              DF     (emulation of old lower level i/o routines)
#              HD     (lower level utilities for developers)
#              HE     (lower level error-handling)
#              HD     (lower level utilities, for developers)
#              DFK    (conversion routines)
#
# ##################################################################
#
#
# PORTING INSTRUCTIONS
# You must modify the lines marked "# ==>".
#

# ==> specify your machine
#MACHINE=PC

INCDIR=..\include
LIBDIR=..\lib
BINDIR=..\bin

# ==> where are your hdf.h, hdfi.h and vg.h files located?
IFLAGS=   /i=$(INCDIR) /i=.

# ==> specify your FORTRAN compiler
#FC=fl
#FFLAGS= /Gt64 /AH $(IFLAGS) /W2 /Od /Tf
#FFLAGS= /AH $(IFLAGS) /W2 /Od /Tf
#FFLAGS= /Gt64 /AH $(IFLAGS) /W2 /Ox /Tf

# ==> specify your C compiler
CC=wcc386
CFLAGS=  /ms /w4 /Od /d2 /s $(IFLAGS) /zc /ze
#CFLAGS= /ms /w4 /Oneatx /s $(IFLAGS) /zc /ze

# ==> specify your Macro-Assembler compiler
MM = ml
MFLAGS = /c /nologo /W3

# ==> where is your HDF library (df.lib) located?
LIBS= $(LIBDIR)\df.lib

# ==> specify your archiver
AR=wlib
ARFLAGS=/q /b
ARFLAGS2=

# ==> specify your archive randomizer
#RANLIB=ranlib

RM=del
RMFLAGS=
LINTFLAGS=

HDRS=hfile.h hdf.h hdfi.h herr.h hproto.h dfan.h dfrig.h dfgr.h dfsd.h &
     dfgroup.h vg.h df.h dfi.h dfstubs.h dfutil.h hconv.h tbbt.h hcompi.h &
     mstdio.h clre.h cnbit.h hbitio.h

CSRCS=hfile.c herr.c hblocks.c hextelt.c hkit.c dfan.c dfr8.c dfcomp.c &
      dfrle.c dfimcomp.c dfjpeg.c dfunjpeg.c dfp.c dfgr.c df24.c dfsd.c &
      dfgroup.c dfconv.c dfufp2i.c vg.c vrw.c vio.c vparse.c vconv.c vsfld.c &
      vgp.c vhi.c dfutil.c dfstubs.c dfknat.c dfkswap.c dfkcray.c dfkvms.c &
      dfkconv.c dfkfuji.c tbbt.c hdfalloc.c maldebug.c hcomp.c mstdio.c &
      crle.c cnbit.c hbitio.c

COBJS=hfile.obj herr.obj hblocks.obj hextelt.obj hkit.obj dfan.obj dfr8.obj &
        dfcomp.obj dfrle.obj dfimcomp.obj dfjpeg.obj dfunjpeg.obj dfp.obj &
        dfgr.obj df24.obj dfsd.obj dfgroup.obj dfconv.obj dfufp2i.obj vg.obj &
        vrw.obj vio.obj vparse.obj vconv.obj vsfld.obj vgp.obj vhi.obj &
        dfutil.obj dfstubs.obj dfknat.obj dfkswap.obj dfkcray.obj dfkvms.obj &
        dfkconv.obj dfkfuji.obj tbbt.obj hdfalloc.obj maldebug.obj hcomp.obj &
        mstdio.obj crle.obj cnbit.obj hbitio.obj

FSRCS=hfilef.c herrf.c dfanf.c dfr8f.c dfpf.c df24f.c dfsdf.c vgf.c dff.c &
      dfutilf.c hfileff.f dfanff.f df24ff.f dfpff.f dfr8ff.f dfsdff.f vgff.f &
      dfff.f dfufp2if.f

FOBJS=hfilef.obj herrf.obj dfanf.obj dfr8f.obj dfpf.obj df24f.obj dfsdf.obj &
      vgf.obj dff.obj dfutilf.obj hfileff.obj dfanff.obj df24ff.obj dfpff.obj &
      dfr8ff.obj dfsdff.obj vgff.obj dfff.obj dfufp2if.obj

JCSRCS= jbsmooth.c jcarith.c jccolor.c jcdeflts.c jcexpand.c jchuff.c &
        jcmain.c jcmaster.c jcmcu.c jcpipe.c jcsample.c jdarith.c jdcolor.c &
        jddeflts.c jdhuff.c jdmain.c jdmaster.c jdmcu.c jdpipe.c jdsample.c &
        jerror.c jquant1.c jquant2.c jfwddct.c jrevdct.c jutils.c jmemmgr.c &
        jrdjfif.c jrdgif.c jrdppm.c jrdrle.c jrdtarga.c jwrjfif.c jwrgif.c &
        jwrppm.c jwrrle.c jwrtarga.c jmemsys.c

JINCS= jinclude.h jconfig.h jpegdata.h jversion.h jmemsys.h egetopt.c

# objectfiles common to both JPEG compression and decompression
#COMOBJECTS= jutils.obj jerror.obj jmemmgr.obj jmemsys.obj jmemdosa.obj
COMOBJECTS= jutils.obj jerror.obj jmemmgr.obj jmemsys.obj
# compression objectfiles
CLIBOBJECTS= jcmaster.obj jcdeflts.obj jcarith.obj jccolor.obj jcexpand.obj &
        jchuff.obj jcmcu.obj jcpipe.obj jcsample.obj jfwddct.obj

CFILEOBJECTS=jwrjfif.obj jrdgif.obj jrdppm.obj jrdrle.obj jrdtarga.obj

# decompression objectfiles
DLIBOBJECTS= jdmaster.obj jddeflts.obj jbsmooth.obj jdarith.obj jdcolor.obj &
        jdhuff.obj jdmcu.obj jdpipe.obj jdsample.obj jquant1.obj &
        jquant2.obj jrevdct.obj

DFILEOBJECTS=jrdjfif.obj jwrgif.obj jwrppm.obj jwrrle.obj jwrtarga.obj

# These objectfiles are included in libjpeg.lib
JOBJS= $(CLIBOBJECTS) $(DLIBOBJECTS) $(COMOBJECTS)

#.f.obj:
#    $(FC) /c $(FFLAGS) $<
#    $(AR) $(ARFLAGS) df.lib $(ARFLAGS2) $*;

.c.obj:
    $(CC) $[@ $(CFLAGS)

.asm.obj:
    $(MM) $(MFLAGS) /Fo $^@ $[@ >$^&.err

all: df.lib install note
    %null

allnostub: libnostub install note
    %null

df.lib: $(COBJS) $(FOBJS) $(JOBJS)
    del df.lib
    $(AR) $(ARFLAGS) df.lib @hdfw386.lbc

libnostub: $(COBJS) $(JOBJS)
    del df.lib
    $(AR) $(ARFLAGS) df.lib @hdfnofw3.lbc

note:
	@echo "^G"
	@echo "***********************************************************"
    @echo " df.lib successfully created."
	@echo ""
	@echo "If you have any old vset files (v 1.0) you must use vcompat"
	@echo "to make them compatible with Vset 2.0 applications"
	@echo ""
	@echo "***********************************************************"
	@echo ""


hdf.h : hdfi.h
    %null

hcompi.h : mstdio.h crle.h cnbit.h
    %null

hfile.obj: hfile.c hfile.h hdf.h herr.h hdfi.h

herr.obj: herr.c hdf.h herr.h hdfi.h

hblocks.obj: hblocks.c hfile.h hdf.h herr.h hdfi.h

hextelt.obj: hextelt.c hfile.h hdf.h herr.h hdfi.h

hkit.obj: hkit.c hfile.h hdf.h herr.h hdfi.h

hdfalloc.obj: hdfalloc.c hdf.h herr.h hdfi.h

dfan.obj: dfan.c hdf.h herr.h dfan.h hdfi.h

dfanf.obj: dfanf.c hdf.h herr.h dfan.h hdfi.h

dfr8.obj: dfr8.c hdf.h herr.h dfrig.h hdfi.h

dfr8f.obj: dfr8f.c hdf.h herr.h dfrig.h hdfi.h

dfcomp.obj: dfcomp.c hdf.h herr.h dfrig.h hdfi.h

dfimcomp.obj: dfimcomp.c hdf.h herr.h dfrig.h hdfi.h

dfrle.obj: dfrle.c hdf.h herr.h dfrig.h hdfi.h

dfjpeg.obj: dfjpeg.c hdf.h herr.h dfrig.h hdfi.h

dfunjpeg.obj: dfunjpeg.c hdf.h herr.h dfrig.h hdfi.h

dfp.obj: dfp.c hdf.h herr.h hdfi.h

dfpf.obj: dfpf.c hdf.h herr.h hdfi.h

dfgr.obj: dfgr.c hdf.h herr.h dfgr.h hdfi.h

df24.obj: df24.c hdf.h herr.h dfgr.h hdfi.h

df24f.obj: df24f.c hdf.h herr.h dfgr.h hdfi.h

dfsd.obj: dfsd.c hdf.h herr.h dfsd.h hdfi.h

dfsdf.obj: dfsdf.c hdf.h herr.h dfsd.h hdfi.h

dfgroup.obj: dfgroup.c hdf.h herr.h hfile.h hdfi.h

dfconv.obj: dfconv.c hdf.h herr.h hdfi.h hconv.h

dfknat.obj: dfknat.c hdf.h herr.h hdfi.h hconv.h

dfkswap.obj: dfkswap.c hdf.h herr.h hdfi.h hconv.h

dfkcray.obj: dfkcray.c hdf.h herr.h hdfi.h hconv.h

dfkvms.obj: dfkvms.c hdf.h herr.h hdfi.h hconv.h

dfkconv.obj: dfkconv.c hdf.h herr.h hdfi.h hconv.h

dfkfuji.obj: dfkfuji.c hdf.h herr.h hdfi.h hconv.h

vg.obj: vg.c vg.h hdf.h hdfi.h

vgf.obj: vgf.c vg.h hdf.h hdfi.h

vrw.obj: vrw.c vg.h hdf.h hdfi.h

vio.obj: vio.c vg.h hdf.h hdfi.h

vparse.obj: vparse.c vg.h hdf.h hdfi.h

vconv.obj: vconv.c vg.h hdf.h hdfi.h

vsfld.obj: vsfld.c vg.h hdf.h hdfi.h

vgp.obj: vgp.c vg.h hdf.h hdfi.h

vhi.obj: vhi.c vg.h hdf.h hdfi.h

tbbt.obj: tbbt.c tbbt.h hdfi.h

hbitio.obj: hbitio.c hbitio.h hdfi.h

maldebug.obj : maldebug.c maldebug.h hdfi.h

hcomp.obj : hcomp.c hdfi.h hcompi.h

mstdio.obj : mstdio.c hdfi.h hcompi.h mstdio.h

crle.obj : crle.c hdfi.h hcompi.h crle.h

cnbit.obj : cnbit.c hdfi.h hcompi.h cnbit.h

dfstubs.obj: dfstubs.c hdf.h herr.h dfstubs.h df.h dfi.h hdfi.h

dff.obj: dff.c hdf.h herr.h dfstubs.h df.h dfi.h hdfi.h

hfileff.obj : hfileff.f

dfanff.obj : dfanff.f

df24ff.obj : df24ff.f

dfpff.obj : dfpff.f

dfr8ff.obj : dfr8ff.f

dfsdff.obj : dfsdff.f

vgff.obj : vgff.f

dfff.obj : dfff.f

dfufp2if.obj : dfufp2if.f

# JPEG source files
jbsmooth.obj : jbsmooth.c jinclude.h jconfig.h jpegdata.h

jcarith.obj : jcarith.c jinclude.h jconfig.h jpegdata.h

jccolor.obj : jccolor.c jinclude.h jconfig.h jpegdata.h

jcdeflts.obj : jcdeflts.c jinclude.h jconfig.h jpegdata.h

jcexpand.obj : jcexpand.c jinclude.h jconfig.h jpegdata.h

jchuff.obj : jchuff.c jinclude.h jconfig.h jpegdata.h

#jcmain.obj : jcmain.c jinclude.h jconfig.h jpegdata.h jversion.h egetopt.c

jcmaster.obj : jcmaster.c jinclude.h jconfig.h jpegdata.h

jcmcu.obj : jcmcu.c jinclude.h jconfig.h jpegdata.h

jcpipe.obj : jcpipe.c jinclude.h jconfig.h jpegdata.h

jcsample.obj : jcsample.c jinclude.h jconfig.h jpegdata.h

jdarith.obj : jdarith.c jinclude.h jconfig.h jpegdata.h

jdcolor.obj : jdcolor.c jinclude.h jconfig.h jpegdata.h

jddeflts.obj : jddeflts.c jinclude.h jconfig.h jpegdata.h

jdhuff.obj : jdhuff.c jinclude.h jconfig.h jpegdata.h

#jdmain.obj : jdmain.c jinclude.h jconfig.h jpegdata.h jversion.h egetopt.c

jdmaster.obj : jdmaster.c jinclude.h jconfig.h jpegdata.h

jdmcu.obj : jdmcu.c jinclude.h jconfig.h jpegdata.h

jdpipe.obj : jdpipe.c jinclude.h jconfig.h jpegdata.h

jdsample.obj : jdsample.c jinclude.h jconfig.h jpegdata.h

jerror.obj : jerror.c jinclude.h jconfig.h jpegdata.h

jquant1.obj : jquant1.c jinclude.h jconfig.h jpegdata.h

jquant2.obj : jquant2.c jinclude.h jconfig.h jpegdata.h

jfwddct.obj : jfwddct.c jinclude.h jconfig.h jpegdata.h

jrevdct.obj : jrevdct.c jinclude.h jconfig.h jpegdata.h

jutils.obj : jutils.c jinclude.h jconfig.h jpegdata.h

jmemmgr.obj : jmemmgr.c jinclude.h jconfig.h jpegdata.h jmemsys.h

jrdjfif.obj : jrdjfif.c jinclude.h jconfig.h jpegdata.h

jrdgif.obj : jrdgif.c jinclude.h jconfig.h jpegdata.h

jrdppm.obj : jrdppm.c jinclude.h jconfig.h jpegdata.h

jrdrle.obj : jrdrle.c jinclude.h jconfig.h jpegdata.h

jrdtarga.obj : jrdtarga.c jinclude.h jconfig.h jpegdata.h

jwrjfif.obj : jwrjfif.c jinclude.h jconfig.h jpegdata.h

jwrgif.obj : jwrgif.c jinclude.h jconfig.h jpegdata.h

jwrppm.obj : jwrppm.c jinclude.h jconfig.h jpegdata.h

jwrrle.obj : jwrrle.c jinclude.h jconfig.h jpegdata.h

jwrtarga.obj : jwrtarga.c jinclude.h jconfig.h jpegdata.h

jmemsys.obj : jmemsys.c jinclude.h jconfig.h jpegdata.h jmemsys.h

#jmemdosa.obj : jmemdosa.asm

install:
	-mkdir $(INCDIR)
    -copy *.h $(INCDIR)
	-mkdir $(LIBDIR)
    -copy df.lib $(LIBDIR)

clean:
    -$(RM) $(RMFLAGS) *.obj

cleanup:
	-$(RM) $(RMFLAGS) df.lib $(UTILS)

lint: $(SRCS) $(R8SRCS)
	$(LINT) $(LINTFLAGS) $(SRCS)

TAGS: $(SRCS) $(HDRS)
	etags $(SRCS) $(HDRS)

