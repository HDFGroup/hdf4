PROJECT ( HDF4_MFHDF_FORTRAN_FORT_PS)

# ---------- Setup output Directories -------------------------
SET (CMAKE_LIBRARY_OUTPUT_DIRECTORY
  ${PROJECT_BINARY_DIR}/Bin
  CACHE PATH
  "Single Directory for all Libraries"
  )

# --------- Setup the Executable output Directory -------------
SET (CMAKE_RUNTIME_OUTPUT_DIRECTORY
  ${PROJECT_BINARY_DIR}/Bin
  CACHE PATH
  "Single Directory for all Executables."
  )

# --------- Setup the Executable output Directory -------------
SET (CMAKE_ARCHIVE_OUTPUT_DIRECTORY
  ${PROJECT_BINARY_DIR}/Bin
  CACHE PATH
  "Single Directory for all static libraries."
  )

SET (HDF4_MFHDF_FORTRAN_FORT_PS_CSRCS
    ${HDF4_MFHDF_FORTRAN_FORT_PS_SOURCE_DIR}/mfsdpf.c
)

SET (HDF4_MFHDF_FORTRAN_FORT_PS_FSRCS
    ${HDF4_MFHDF_FORTRAN_FORT_PS_SOURCE_DIR}/mfsdpff.f
)

INCLUDE_DIRECTORIES( ${HDF4_HDF_SOURCE_DIR} )
INCLUDE_DIRECTORIES( ${HDF4_MFHDF_SOURCE_DIR} )

IF(WIN32)
  ADD_DEFINITIONS(-D_HDFLIB_)
ENDIF(WIN32)

SET_SOURCE_FILES_PROPERTIES( ${HDF4_MFHDF_FORTRAN_FORT_PS_CSRCS} PROPERTIES LANGUAGE C) 
SET_SOURCE_FILES_PROPERTIES( ${HDF4_MFHDF_FORTRAN_FORT_PS_FSRCS} PROPERTIES LANGUAGE FORTRAN) 

IF (BUILD_SHARED_LIBS)
  IF(WIN32)
    ADD_DEFINITIONS(-D_HDFDLL_ -D_HDFLIB_C_STUB_EXPORTS -DUSRDLL -D_HDF_USEDLL -DHDF_FCSTUBDLL_EXPORTS)
  ENDIF(WIN32)
  ADD_LIBRARY(${HDF4_MFHDF_FCSTUB_LIB_NAME} SHARED ${HDF4_MFHDF_FORTRAN_FORT_PS_CSRCS} )
  ADD_LIBRARY(${HDF4_MFHDF_FORTRAN_LIB_NAME} SHARED ${HDF4_MFHDF_FORTRAN_FORT_PS_FSRCS} )

  # Help CMake 2.6.x and lower (not necessary for 2.8 and above, but doesn't hurt):
  SET_TARGET_PROPERTIES(${HDF4_MFHDF_FCSTUB_LIB_NAME} PROPERTIES COMPILE_FLAGS "${SHARED_C_FLAGS_RELEASE}")
  TARGET_LINK_LIBRARIES(${HDF4_MFHDF_FCSTUB_LIB_NAME} ${LINK_LIBS})
  SET_TARGET_PROPERTIES(${HDF4_MFHDF_FCSTUB_LIB_NAME} PROPERTIES CLEAN_DIRECT_OUTPUT 1)
  SET_TARGET_PROPERTIES(${HDF4_MFHDF_FORTRAN_LIB_NAME} PROPERTIES COMPILE_FLAGS "${SHARED_FORTRAN_FLAGS_RELEASE}")
  TARGET_LINK_LIBRARIES(${HDF4_MFHDF_FORTRAN_LIB_NAME} ${LINK_LIBS})
  SET_TARGET_PROPERTIES(${HDF4_MFHDF_FORTRAN_LIB_NAME} PROPERTIES CLEAN_DIRECT_OUTPUT 1)
ENDIF (BUILD_SHARED_LIBS)

ADD_LIBRARY(${HDF4_MFHDF_FCSTUB_LIB_NAME}-static STATIC  ${HDF4_MFHDF_FORTRAN_FORT_PS_CSRCS})
SET_TARGET_PROPERTIES(${HDF4_MFHDF_FCSTUB_LIB_NAME}-static PROPERTIES OUTPUT_NAME "${HDF4_MFHDF_FCSTUB_LIB_NAME}")
SET_TARGET_PROPERTIES(${HDF4_MFHDF_FCSTUB_LIB_NAME}-static PROPERTIES PREFIX "lib")

ADD_LIBRARY(${HDF4_MFHDF_FORTRAN_LIB_NAME}-static STATIC  ${HDF4_MFHDF_FORTRAN_FORT_PS_FSRCS})
SET_TARGET_PROPERTIES(${HDF4_MFHDF_FORTRAN_LIB_NAME}-static PROPERTIES OUTPUT_NAME "${HDF4_MFHDF_FORTRAN_LIB_NAME}")
SET_TARGET_PROPERTIES(${HDF4_MFHDF_FORTRAN_LIB_NAME}-static PROPERTIES PREFIX "lib")

# Help CMake 2.6.x and lower (not necessary for 2.8 and above, but doesn't hurt):
SET_TARGET_PROPERTIES(${HDF4_MFHDF_FCSTUB_LIB_NAME}-static PROPERTIES CLEAN_DIRECT_OUTPUT 1)
SET_TARGET_PROPERTIES(${HDF4_MFHDF_FORTRAN_LIB_NAME}-static PROPERTIES CLEAN_DIRECT_OUTPUT 1)

#-----------------------------------------------------------------------------
# Add library to CMake Install : Installs lib and cmake config info
#-----------------------------------------------------------------------------
INSTALL(
  TARGETS 
    ${HDF4_MFHDF_FCSTUB_LIB_NAME}-static
  EXPORT 
    hdf4-targets
  LIBRARY DESTINATION lib 
  ARCHIVE DESTINATION lib
  RUNTIME DESTINATION bin
)

IF (BUILD_SHARED_LIBS)
INSTALL(
  TARGETS 
    ${HDF4_MFHDF_FORTRAN_LIB_NAME}
  EXPORT 
    hdf4-targets
  LIBRARY DESTINATION lib 
  ARCHIVE DESTINATION lib
  RUNTIME DESTINATION bin
)
ENDIF (BUILD_SHARED_LIBS)
